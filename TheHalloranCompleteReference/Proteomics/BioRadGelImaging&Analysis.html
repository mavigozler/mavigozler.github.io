<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Bio-Rad Gel Imaging &amp; Analysis</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="/style/std.css" type="text/css" rel="stylesheet">
<style type="text/css">
 blockquote {width:50%;font:normal 100% 'Courier New',Courier,monospace;}
 a{color:red;}
 a:hover{color:green;}
</style>
</head>
<body>
<p id="title">
Bio-Rad Gel Imaging &amp; Analysis


<div class="outerblock">

<h1>Start Up of VersaDoc and PDQuest</h1>
<ol>
<li>Find the power switch on the VersaDoc 1000 and turn it on.  The switch is on 
the back of the VersaDoc 1000.

<li>Turn on the PC running Windows 2000 that runs the PDQuest software. Open the 
PDQuest software.

</ol>

<h1>Place Gel in VersaDoc</h1>

<ol>
<li>If the gel is a Coomassie- or silver-stained gel, take the white light 
conversion screen to the sink with the gel.

<li>Squirt liberal amounts of water on the conversion screen.

<li>Recover the gel from the glass dish:  it is possible to handle it with 
gloved hands, but it can also be recovered by using plastic wrap (stretch film) 
or even a glass plate placed in the dish and pulling the gel on to it, then 
slowly lifting the material containing the gel on to the conversion screen. 
While pulling away the glass plate or plastic wrap, keep the gel held on the 
conversion screen.  Develop the best gel transfer method that works for you.

<li>Place the conversion screen with gel on top of the UV illumination area of 
the transilluminator within the VersaDoc.  Try to adjust and center the gel 
(this will also be done during preview imaging).

<li>Place the Bio-Rad ruler or other photographic ruler as close as possible to 
any side of the gel.  It <strong>MUST</strong> be visible in the imaging of the 
gel.  The ruler is not really required if no robotic (automated) spot cutting
is to be done, but it is always a good idea to have the correct size information
about the gel.  The computation and entry of the size information is discussed
below.

<li>If a normalizing intensity scale or grid is available, also place it next
to the gel.  This can help normalize intensities across gels and thus help
in spot quantitation.

<li>Do not close the VersaDoc door yet.
</ol>

<h1>Acquiring the Image</h1>
<p>
Before the image can be acquired, the components of the VersaDoc camera should 
be understood.  Read <a href="#fundamphoto">this general introduction to 
photography</a> for understanding more.

<ol>
<li>Under the <b>File</b> menu, select <b>VersaDoc...</b>.  The VersaDoc image 
acquisition window opens.

<li>The first step is to select one of four channels. A channel allows for 
different applications (different types of stains) to be imaged on the same gel. 
Channels can be superimposed on top of one another.

<li><b>Setting Imaging Type</b>. Select the type of application:  protein gel 
usually.  A staining submenu opens to allow selection of the type of stain.  If 
<b>Custom</b> is selected, a custom application is created and then settings 
selected by the user.  These include setting the filter, illumination, gain, and 
binning.

<li><b>Initializing the Camera Elements</b>. Set the zoom on the camera to the 
widest angle (lowest number on the zoom ring, probably 20 mm).  Also set the 
f-stop to f/4 or even lower.  This prepares you for framing the gel in the field 
of view and getting the right illumination.

<li><b>Position/Focus</b>.  Click the <b>Position</b> button.  The VersaDoc 
positioning lights come on and the camera begins taking images once every 
second.  Check on the <b>Show Alignment Grid</b>.  If it is difficult to see the 
gel at all or the gel in its entirety, it means you did not set the zoom ring to 
the widest angle.  At the widest angle, it should be able to see the whole tray 
within the VersaDoc chamber.

<li><b>Centering and Framing in Position</b>. While the Position function is on, 
the camera will be taking 1 second exposures and updating the viewed image. 
During this time, try to center the image left and right, top and bottom.  Use 
the blue-lined squares of the alignment grid to help in the centering of the 
gel.  After the first attempt at centering, then increase the zoom setting: 
magnify the gel as much as possible to fill the field of view without losing the 
data on the gel.  Either the left and right or top and bottom edges will be the 
first to fall out of the field of view if the zoom is too high.  If one edge 
comes the edge of the field of view and the opposite edge is not even close, 
then re-center the gel, and continue to change the zoom.

<li><b>Focusing</b>. Click the <b>Stop</b> button to cease the Position 
function.  Now click <b>Focus</b>.  The camera will zoom in (digitally, not by 
adjusting the zoom ring) to the middle part of the gel to magnify bands.  The 
sharpness and resolution of the bands in this centered region of the gel will be 
used to determine the focus.  Adjust the focusing ring back and forth, slowly, 
and wait for image update.  Purposely adjust the focus to see it blurred on 
either extreme to be able to understand what a good focus is.  Since the lens is 
about 80 cm away from the gel, experience has shown that the focus setting is 
usually 0.8 (80 cm).

<li><b>Using Optimize Exposure</b>. Click the Stop button to cease the focus 
function.  There are several possibilities for the next step, which is to 
acquire the image by setting the correct exposure time.  One can set the time in 
the input box and then click the Preview button to see a preview.  Alternatively 
pressing the Acquire button will take a single image for the set exposure time 
and present it in a separate image document window, which can be saved. Perhaps 
the best method is to take several exposures over a range of times, and then 
select the best exposure from the set.  The best method that has been found to 
work is to click Optimize Exposure, set the number of exposures to be 7 or 8, 
and then set the exposure time from the lowest to the highest.  For Coomassie 
and silver stained gels on the light conversion tray, the typical times are from 
0.1 to 0.8 seconds.  Thus if 8 exposures are obtained, the first will be 0.1 
second, the second 0.2 seconds, up to the 8th exposure at 0.8 seconds. 
Flourescent gels require much longer exposure times, and depending on whether 
the SYPRO dyes are being re-used or are fresh.  For fresh dye, usually from 1 to 
10 second exposures are necessary.  But for re-used dyes, from 4-30 seconds and 
even longer might be required.  For very weakly fluorescent gels, it might take 
60-120 seconds to visualize something:  this usually means very little protein. 
When producing multiple exposures through Optimize Exposure, do not 
automatically save the images, since not all of the images will be wanted 
anyway, and the unwanted images will take up lots of precious hard drive disk 
space and make file management difficult.

<li><b>Selecting and Saving Image Files; File Naming</b>. It will be easy to 
eliminate to the images that are at the extreme. So click those away and don't 
save them.  Narrow down the choices to 3 or 4 good images and fit them all on 
the screen for simultaneous viewing.  Most of the time, only one image is 
wanted, but sometimes it is good to put keep a second different exposure 
(<q>just in case</q>).  When saving the images to be kept, do not use the 
silly default name, which puts the name of the user, the date and time and 
version of the image as GSC file. Keep the version (<q>v</q> number) of 
the gel.  But when naming the file, use something descriptive, although 
abbreviate somewhat to keep the filename short.  For example, if the gel from a 
project of looking at cortisone-treated rats and the gel is silver-stained 
(while another gel is also run but is SYPRO Ruby-stained), then including the 
name of the staining method is proper too: <q>cortisone rat Ag-stain 
v1.gsc</q> is a good name in that case.  Include enough keywords to be able 
to distinguish gels within a single project folder. This is the abiding rule.

</ol>

<h1>File Types Used By PDQuest</h1>
<ul>
<li><b>.gsc</b>: the <q>raw</q> (unprocessed after image acquisition)
2D scans
<li><b>.gim</b>: images which have been filtered as part of processing
<li><b>.gsp</b>: images which have been filtered and converted to
Gaussian spot representations
<li><b>.csc</b>: Calstrip scans
<li><b>.ms</b>:  called the <b>MatchSet</b> up to version 7; in version 8,
now called <b>Experiment</b>
</ul>
<p>
A <b>MatchSet/Experiment</b> is actually set of scans or images that have been 
analyzed and compared.  The images in a MatchSet are called <i>members</i>. The 
members of a MatchSet can be Raw 2-D, Filtered, or Gaussian types.
<p>
The types of analyses that can be done within a MatchSet include:
<ul>
<li>spot comparisons between gels
<li>MW or pI value determinations
<li>spot annotation
<li>spot grouping for analytical sets
<li>replicate spot evaluation
<li>spot excision selection
</ul>
<p>
A <b>ScanSet</b> represents three different files of the same root image.  These 
are the Raw 2-D, Filtered, and Gaussian images.
<p>
An <b>Analysis set</b> is a set of spots chosen for study. Groups of spots can 
be selected that have statistical and biological significance.

<h1>Images Are Three-Dimensional</h1>
<p>
The images are really three dimensional (<i>xyz</i> coordinated). The <i>x</i> 
and <i>y</i> represent the two dimensional area (width and height, respectively) 
of the gel, while the <i>z</i> axis represents an intensity value.  For a 
black-and-white image, there are shades of gray in between.  For all images, the 
intensity is scaled into 4096 levels or 12-bit intensity (2<sup>12</sup> = 
4096).  With older software, one usually got only 8-bit intensity levels (256 
levels).  Better systems now provide 16-bit (at total of 65536) intensity levels.
<p>
Thus a black spot representing an image of a stained protein can assume one of 
4096 intensity levels.  White has a value of 0 and black has a value of 4095, 
and the levels of gray are in between to make up the 4096 levels.

<h1>Entering Gel Size Information</h1>
<p>
The image of the gel should contain an image of a ruler on one of its sides
before cropping to the final image.  This is vital for doing automated spot
cutting, because the ruler is used to relate pixel of the image to gel distance
(height and width in millimeters).
<p>
Perform the following steps:
<ol>
<li>Maximize the image window
<li>Use the Draw-to-Zoom tool on the horizontally or vertically edge of the
ruler that contains the numbers and their marks.  Draw the zoom marquee so that
it miminally contains the numeral "1" mark and contains the "11" mark for big
gels, or from numeral "1" to numeral "6" if it is a small (mini) gel.  
The ruler will generally be centered in the window now.  Don't worry that the 
gel is not visible.
<li>Call the Custom Rotation tool:  a circle like a compass with crossed lines
with an arrow at top appears.
<li>Select the Hand tool, which allows movement of the image.  Use the Hand
tool to move the visible measuring edge of the imaged ruler so that one part of it
is contacting the circled point where the two crossed lines meet.
<li>Re-select the Custom Rotation tool:  rotate it so that the vertical (arrowed)
line aligns exactly with a ruler edge that is vertical, or so that the horizontal
(nonarrowed) line aligns exactly with a ruler edge that is horiontal.  Click the
Rotate button.
<li>A new window appears as a result of the rotation.  The gel version was changed
too:  if it was v1, it is now v2.  Click the Close button on the previous 
version.  It will really no longer be of value or needed.  If desired save it.
Maximize the new version window.
<li>Select the Crop box tool.  Draw a box so that one side aligns with the
numeral "1" and the other aligns with numeral "11" (for big gels) or numeral
"6" for small gels.  Dimensions appear in both millimeters (mm) and pixels.
At least one of the millimeter dimensions should be 100 (if from numeral "1"
to "11") or 50 (in from numeral "1" to "6").  But clearly it is not.  The
camera has no information to give the software about size of an image.  When
the camera zoom changes, so does the concept of size.  The important value to 
note here is the pixel quantity.  Remember it or write it down.
<li>Now call up the <b>Image Info</b> window (Ctrl + I keys).  In the window
the width (X) and height (Y) dimensions are shown in mm and pixels.  The important
value is the pixels.  Select the X dimension and it shows the width in pixels of
the entire image.
<li><b>Calculating the Size</b>.  The calculation that will be done is to calculate
the X dimension in millimeters.  This will be actual.  The formula is:
<table class="eqnserif">
<tr><td rowspan="2" style="width:15em;">width (<i>X</i>) dimension 
in millimeters
  <td rowspan="2" style="padding:0 1em;">= 
  <td class="numer" style="width:15em;">Length of the imaged ruler in millimeters
	<td  rowspan="2"  style="padding:0 1em;">&times;
  <td  rowspan="2" style="width:20em;">width (<i>X</i> dimension in pixels
   <br>(from the Image Info window)
<tr><td>Length of the imaged ruler in pixels
</table>
 <p>The three values on the right-hand side of the equation should be known
for calculating the value on the left-hand side.  As a realistic example, 
suppose the three values are as follows:
 <ul>
 <li><b>Length of imaged ruler in millimeters</b>:  this must either be 100 mm for 
big gels or 50 mm for small gels based on the description given above.  Suppose in
this example it is 100 mm for a big gel image.
 <li><b>Width of imaged ruler in pixels</b>:  from the crop box created, suppose
it was 510 pixels.
 <li><b>Width (X) dimension of image</b>:  suppose this value was 1322 pixels,
obtained from the Image Info window
 </ul>
<p>
So the calculated size is
<table class="eqnserif">
<tr><td rowspan="2" style="width:15em;">width (<i>X</i>) dimension 
in millimeters
  <td rowspan="2" style="padding:0 1em;">= 
  <td class="numer" style="width:8em;">100 mm
	<td  rowspan="2"  style="padding:0 1em;">&times;
  <td  rowspan="2" style="width:8em;">1322 pixels
  <td rowspan="2" style="padding:0 1em;">= 
  <td rowspan="2" style="font-size:125%;"> 259.2
  <td rowspan="2">mm
<tr><td>510 pixels
</table>
<li>Once the calculation is made, open the Image Info window again (use
Ctrl+I keys), and find the X dimension in mm.  Enter the value.  When the
tab key is pressed, this should automatically change the Y (height) value
in mm, so there is no need to calculate it.
</ol>
<p>
To review:
<ul>
<li>The image ruler is centered and rotated so that an accurate measure
of the ruler can be made using the crop box.
<li>The crop box shows the ruler's length in pixels, so that the ratio of
millimeters-to-pixels can be obtained.
<li>The width of the entire image in pixels is then obtained.
<li>The width of the entire image in millimeters is then computed from the
values obtained, and this value is updated to the Image Info window.
</ul>
<p>
This is absolutely essential for doing automated spot cutting.  Without it
being done accurately, the gel cannot be cut (except manually).

<h1>Cropping and Rotation To Produce Working Image</h1>
<p>
After using the ruler to 


<h1>Transforming and Filtering Images</h1>
<p>
The <b>Image&mdash;&gt;Transform</b> command only adjusts the image brightness 
and contrast on the screen, and does not actually change image intensity data. 
Nonetheless, it helps the user find the regions of the gel with real spot data 
so that only those are manipulated and considered.
<p>
Generally the <b>auto-scale</b> is the best feature to use in Transform. The 
scale is readjusted so that the lowest intensity spot (which might be a gray 
level) is set to white, and the highest intensity spot is set to black.  All 
intensities in between them are re-calculated so that they are properly spaced. 
The following formula generally describes this process:
<table class="eqnserif">
<tr><td class="numer">(<i>PI</i><sub>2</sub> &minus; <i>MinPI</i><sub>2</sub>)
 <td rowspan="2" style="padding:0 1em;"> =
 <td class="numer">(<i>PI</i><sub>1</sub> &minus; <i>MinPI</i><sub>1</sub>)
<tr><td>(<i>MaxPI</i><sub>2</sub> &minus; <i>MinPI</i><sub>2</sub>)
 <td>(<i>MaxPI</i><sub>1</sub> &minus; <i>MinPI</i><sub>1</sub>)
</table>
<p>
where <i>PI</i> is the pixel intensity for any pixel in the image,
<i>MinPI</i> is the lowest pixel intensity in the image, and <i>MaxPI</i>
is the highest pixel intensity in the image.  For <i>PI<sub>n</sub></i>,
<i>MaxPI<sub>n</sub></i>, and <i>MaxPI<sub>n</sub></i>, <i>n</i> = 1 refers
to the old intensity and <i>n</i> = 2 to the new (re-scaled) intensity.
<p>
This re-arranges algebraically:
<table class="eqnserif">
<tr><td rowspan="2"><i>PI</i><sub>2</sub> =
 <td class="numer">(<i>PI</i><sub>1</sub> &minus; <i>MinPI</i><sub>1</sub>)
    (<i>MaxPI</i><sub>2</sub> &minus; <i>MinPI</i><sub>2</sub>)
 <td rowspan="2" style="padding-left:1ex;"> + <i>MinPI</i><sub>2</sub>
<tr><td>(<i>MaxPI</i><sub>1</sub> &minus; <i>MinPI</i><sub>1</sub>)
</table>
<p>
as <i>PI</i><sub>2</sub> is the re-scaled (new) intensity.
<p>
As an example, suppose the raw image has a minimum intensity of 650 and a 
maximum of 3168.  The new re-scaled (or auto-scaled) image will convert that 
maximum of 3168 to 4095 (black), and the 650 value will be made 0 (white).  Note 
that the midpoint between 650 and 3168 is (3168 &minus; 650) / 2 + 650 = 1909. 
Thus all pixel intensities less than or equal to 1909 will have a value lower 
than their original intensity in the re-scaled image, and those above 1909 will 
have a value higher than their original intensity.  In the equations below, the 
intensity of 2398 (one above 1909) and of 1103 (one below 1909) are calculated:

<table class="eqnserif">
<tr><td rowspan="2"><i>PI</i><sub>2</sub> =
 <td class="numer">(2398 &minus; 650) (4095 &minus; 0)
 <td rowspan="2" style="padding-left:1ex;"> + 0 = 2843
<tr><td>(3168 &minus; 650)
</table>

<table class="eqnserif">
<tr><td rowspan="2"><i>PI</i><sub>2</sub> =
 <td class="numer">(1103 &minus; 650) (4095 &minus; 0)
 <td rowspan="2" style="padding-left:1ex;"> + 0 = 737
<tr><td>(3168 &minus; 650)
</table>

<p>
One notes that these re-scaling calculations create an image with a far
greater contrast.  The essential defintion of contrast is to enhance the
differences between black and white, which is occurring by this transformation.
<p>
There is plenty on the Internet about the fundamentals of image filtering and 
smoothing:

<ul>
<li><a href="http://www.bioss.sari.ac.uk/~chris/ch3.pdf">http://www.bioss.sari.ac.uk/~chris/ch3.pdf</a>
</ul>


<h1>Detecting Spots</h1>
<p>
There are basically two different ways to detect spots in PDQuest. There are 
advantages and disadvantages to both.
<ol>
<li>The automatic way:  that is, let the computer software do it. The advantage 
is that the computer does a fair job of actually detecting hundreds, and as much 
as thousands, of spots that really do represent stained protein spots.  This 
saves time in manually selecting spots that number in the hundreds and 
thousands.  The disadvantage is that the spot detection algorithms
<li>The manual way:  that is, you do the detecting.  The disadvantages of this 
method are clear.  When there is a gel with hundreds or thousands of spots, 
selecting each one is both time-consuming and tiring.
</ol>
<p>
There is a reason that it is called <q>spot detection and editing</q> 
however.  The <i>spot detection</i> part essentially refers to letting the 
computer the spots automatically, and the <i>spot editing</i> part refers to the 
user adding or deleting spots manually after the computer has been allowed to go 
first.
<p>
To some degree, even the automatic spot detection system is manually controlled 
by the user.  The user can set three important parameters used by the spot 
detection algorithms in the software:
<ul>
<li><b>Sensitivity</b>:  this sets the intensity threshold relative to
 maximum spot intensity for a spot  to be detected (a measure of
 signal-to-noise ratio).  Increasing the sensitivity value increases the number
 of spots detected.  If gel noise is being detected, lower the sensitivity
 value or use the <b>Speckles</b> removal control.
<li><b>Minimum Peak</b>:  while sensitivity adjusts signal-to-noise,
 minimum peak just looks at the signal to see if it passes a certain
 threshold.  That signal could also be noise if the threshold is set too low.
 Adjust this parameter after first adjusting sensitivity in the Step 2
 process or selecting new Faint (fainter) spots in the Step 1 process.
<li><b>Size Scale</b>:  this parameter looks at the size (area) of
 <i>objects</i> to understand if they represent signal (spots) as opposed
 to noise (intensity fluctuations not representing spots).  Larger values
 may be used when the noise is rather noticeable, but smaller values might
 be used if the noise has been smoothed out.
</ul>
<p>
Spots on a gel are actually represented three-dimensionally.  The two dimensions 
are the location (<i>x,y</i>) of the spot on the gel.  The third dimension 
(<i>z</i> axis) is the intensity of the spot, measured as a three dimensional 
peak which has an amplitude.  The peak also has a perimeter (or circumference) 
at the base, which corresponds to the Size Scale.
<p>
There are two ways to set these three parameters for automatic spot detection. 
In the <b>Spot Detection Parameter Wizard</b> or in another spot detection 
interface, the user can set numeric values either by entering them directly or 
using up or down arrows.  These are in the <b>Step 2 - Test Settings</b> 
fieldset of the wizard.  Or the user can go to <b>Step 1 - Give Manual 
Guidance</b>, which essentially determines the initial parameters by having the 
user select faint and/or small spots, and then box the largest spot.  If doing 
either Step 1 or updating the numeric values directly in Step 2.  Note that by 
changing any of the three parameters in the Test Settings fieldset, the spot 
centers are immediately re-evaluated using the changed parameter.  Keep track of 
the <b>Spot Count</b> during every update.   As one raises the Sensitivity 
level, the Spot Count should go up since it requires spots to have a lower 
threshold to be detected.   If the Size Scale is raised, the Spot Count should 
also decrease since this is the minimum size required
<p>
Note that Bio-Rad reports the following in the Step 1 process:
<ul>
<li><b>Faint</b> spot selection:  find the faintest spot you want to detect
sets both the <i>sensitivity</i> and <i>minimum peak</i> parameters.
<li><b>Small</b> spot selection:  this spot should be <em>smaller</em>
than the faintest spot.  This does not mean that it is actually fainter
than the faintest spot.  It must be smaller and more intense.  If the faint
spot is also the smallest spot, then do not select a small spot.
Selecting a small spot helps to set the <i>size scale</i> parameter
<li><b>Largest Spot Cluster</b> selection:  this will set the <i>radius</i>
of the <b>background subtraction rolling ball</b> and of the <b>streak
removal rolling disk</b>.
</ul>

<h1>Streaks</h1>
<p>
Streaks are typically found in areas of high spot concentrations.
Click the checkboxes for the kind of streaking you want to remove.
<p>
A disk radius is used to evaluate whether streaking has occurred, based
on the size of the largest spot cluster selected.  Streaks are removed
by reducing the size of the disk radius.
<p style="color:blue;">
Reduce the radius by half and do spot detection.  Repeat this process
until the streaks are not detected.

<h1>Background</h1>
<p>
Background subtraction is required for spot detection.  A floating ball is used 
as the method, its radius calculated from the largest spot cluster detected. 
The ball radius can be changed, but it is <em>highly recommended</em> that the 
calculated default be kept.

<h1>Smoothing</h1>
<p>
Smoothing is a <i>noise reduction</i> process, along with background 
subtraction.  These processes are usually always done when any signal is 
significantly accompanied by noise.
<p>
The smoothing of a jagged line in one dimension, or the filtering of a noisy
image in two dimensions, is done by looking that the neighboring adjacents
signals around the signal whose value is to be adjusted.  Consider
a pixel whose intensity is 900.  It is surrounded by 8 pixels (assuming
it is not an edge or corner pixel).  Suppose their intensities are as follows:
<pre>
      882   892   903

      891   900   909

      897   896   902
</pre>
<p>
The mean of all those intensities is 896.8.  Thus the value 900 at the center 
can be made the mean of itself and all the values around it.  The value is then 
filtered, in a 3 &times; 3 kernel centered at the pixel to be adjusted.  The 
kernel itself can be made bigger: 5 &times; 5, 7 &times; 7, 9 &times; 9, etc. 
By including more surrounding pixels, the influence of these pixels on the pixel 
at the center is greater, and the adjusted pixel is brought closer to the values 
of the neighboring pixels.  Thus a larger kernel achieves better smoothing. 
However, a larger kernel can also reduce signal intensity and thus the 
signal-to-noise ratio.
<p>
The filter algorithm works by moving in raster-like fashion along a row of image 
pixels.  The filtering window describes what values will be obtained of the 
centered pixel and surrounding pixels.  These values are then processed 
according to the type of filter selected, and then the pixel at the center of 
the window (kernel), that is the pixel being processed, is changed or not 
changed according to the specification of the filter.  Processing occurs pixel 
by pixel within a row, then row by row within the image.
<p>
Smoothing is achieved in gel image data by applying <b>filters</b>.
The filters available are:
<ul>
<li><b>Median</b>.  This is more effective at dealing with so-called salt and 
pepper noise, and does little to smooth out Gaussian noise. If a small window is 
selected (3&times;3 vs. 9&times;9), less blurring is created in the signal. 
This filter evaluates the median of all values in the kernel (window) and 
replaces the pixel being processed with the median value.
<li><b>Weighted Mean</b>.  In contrast to the Median filter, this is more 
effective at dealing with Gaussian noise and less effective with salt and pepper 
type noise.
<li><b>Power Mean</b>.  This filter should be used to control salt and Gaussian 
noise;  it will worsen the pepper noise.  The power mean of all pixel 
intensities in the kernel is determined, and the value replaces the value of the 
processed pixel.
<li><b>ContraMean</b>.	Use this for smoothing pepper and Gaussian noise; will 
worsen the effect of salt.  The contra-harmonic mean of all pixel intensities in 
the kernel is evaluated, and this value replaces the value of the processed 
pixel.
<li><b>Adaptive</b>.  When all the other filters have not worked with a 
particularly noisy gel, then try this.  It is best to use this filter when there 
is a mix of salt and pepper noise.
<li><b>Out of Range Pixel (Mean)</b>.  Used to suppress salt and pepper noise, 
with minimal effects on Gaussian noise.  This is a strictly <i>mean</i> filter: 
the mean of all pixels in the kernel is evaluated;  if the difference between 
the mean and the pixel being processed rises above a threshold, the processed 
pixel is replaced by the mean.
<li><b>Maximum</b>.  This filter can eliminate pepper noise (and will worsen the 
effect of salt noise).  It replaces the processed pixel with the maximum 
intensity value of the pixels in the kernel (window).
<li><b>Minimum</b>.  This filter is better for eliminating salt noise and will 
worsen the effect of pepper-like noise.  It replaces the processed pixel with 
the minimum intensity value of any pixel in the kernel (window).
<li><b>Mid-Value</b>.  This filter is best for suppressing uniform noise within 
an image and will make pepper and salt noise worse.   The algorithm finds the 
minimum and maximum pixel intensities within the kernel, then finds their 
midpoint (the mean of these two values), and replaces the processed pixel with 
that value.
</ul>

<p>
The <b>Kernel Size</b> (filtering window) is the window matrix
to which all steps of the filtering processing algorithm are applied.
<p>
This should be set as follows:
<ol>
<li>Magnify a background region to see the individual pixels and look at
several noise features, and determine the average size.  Move the gel
around if necessary.
<li>Magnify the smallest spots and determine the pixel dimensions.
<li>The Kernel Size should be <em>larger</em> than the average noise
size, but <em>smaller</em> than the pixel area of the smallest spots.
</ol>

<h1>File Type Conversions and Considerations</h1>
<p>
TIFF images are importable but are missing information about the
type of scanner, color, etc. that were used in image acquisition.
There are many types of TIFF files, and PDQuest is able to import
8- and 16-bit grayscale uncompressed formats.
<p>
JPEG is an export format used to prepare reports and presentations,
and is used more than TIFF because of its ability to compress data.
PDQuest cannot import JPEG files.  When exporting, a quality setting
between 50-80 is usually a good compromise between image quality
and file size (the higher the quality, the larger the file size).
<p>
MatchSet data can be exported to a Text file for import of info
into spreadsheets.  Exportable data includes spot position, quantity,
quality, Gaussian size, normalized quantity and peak value.
Data can also be exported in an XML format.

<h1>Spot Editing</h1>
<p>
Adding and removing spots can be done with the raw and filtered images.
Bio-Rad also recommends using the Gaussian image too, especially with
match sets.
<p>
Check the gel image with its spot center crosshairs overlaid on the image.
Carefully inspect the Raw and Filtered images as follows:
<ol style="list-style-type:lower-alpha;">
<li>Look at the spots without the overlaid cross hairs.  Count the number
of spots in the Raw and Filtered image, both zoomed out and zoomed in,
and come to an agreement as to what you see.
<li>Now overlay the spot center crosshairs on to the image.  See if the
count of crosshairs agrees with the count you made.
<li>If not, remove spot center crosshairs that clearly do not correspond
to the center of the spots you have visualized.  If there are spots with
no crosshairs to their centers, add them.
</ol>
<p>
The result of this manual editing will be that the correct number of
spots are made and their centers determined.
<p>
Note that there is a difference betweeng <i>cancelling</i> and
<i>removing</i> spots.  Cancelling spots in scansets or matchsets
removes the spot from being considered in matching or other analyses,
but keeps the information about the spot.  Removing a spot takes it
out of the Gaussian member of the set, indicating that there is no spot
at all entirely.
<p>
Spots that are cancelled can be restored by selecting them or a group of
them and using the Restore command in the Spot tools.
<p>
<b>Combining</b> spots is used to combine a cluster of spots into one.
It is done on Filtered images of a scanset or matchset.  The Gaussian
image shows a single spot although the raw and Filtered images show
several spots.  This combining of spots will be quantitated as a single
spot.

<h1>Quantitation</h1>
<p>
The quantity of the Gaussian image spots is evaluated by the following equation:

<p class="eqnserif">
spot quantity = <i>spot height</i> &times; &pi; &times; &sigma;<sub><i>x</i></sub> &times;
&sigma;<sub><i>y</i></sub>
<p>
where <i>spot height</i> is essentially the peak intensity.  The value for the 
spot height (intensity) has dimensions of either <b>OD</b> (<i>optical 
density</i>) or <b>counts per square image units</b> (OD/IU<sup>2</sup> or 
counts/IU<sup>2</sup>), depending on imaging device.  One image unit (IU) is 0.1 
mm (100 &micro;m). &sigma;<sub><i>x</i></sub> is the standard deviation of the 
spot along the <i>x</i> axis, and &sigma;<sub><i>y</i></sub> is the standard 
deviation along the <i>y</i> axis, which are measured in IU values.
<p>
The <i>spot quantity</i> will have dimensions of ODs or counts when the equation 
is evaluated.  This system is preferable to summing the pixel intensity values.

<h1>Spot Quality</h1>
<p>
The software has the ability to score <i>spot quality</i> based on the following 
factors:
<ol>
<li><b>Gaussian fit</b>.  Assigns a value to how well the spot fits the
Gaussian model.
<li><b>X-streaking</b>.  Determines how much of the spot is affected by
gel streaking in <i>x</i>-direction.
<li><b>Y-streaking</b>.  Same determination as for X-streaking, but in
<i>y</i> direction.
<li><b>Overlap</b>.	Determines percentage of spot overlapping with other
spots.
<li><b>Linear Range of Scanner</b>.  Is the peak intensity within the
linear range of the scanner?
</ol>
<p>
The score is from 0 to 100.  A value of 100 is assigned to spots which fit the 
Gaussian model perfectly, have no streaking in <i>x</i> or <i>y</i> direction, 
no overlap with any spot, and has a peak intensity within the scanner measuring 
range.

<h1>Problems with Saturation</h1>
<p>
Spot intensities can have a maximum value of 4095.  There are some cases where 
the image analysis has a large spot region where the maximum value is reached at 
a contour far from the spot center.  It can be assumed that center itself is at 
a greater intensity than those on the contour several (or several tens) of 
pixels away from it.  Spot boundaries and contours help to make determinations 
about spots who intensity levels are such that the peak may be saturating.  The 
boundary tools can help to instruct the Gaussian image about the true size of 
the spot for purposes of quantitation.  Drawing boundaries with the tool or 
freehand draw tool can also be used in spot matching procedures with other gels.

<h1>Spot Numbering</h1>
<p>
The system uses an <b>SSP</b> or <b>standard spot</b> numbering assignment to 
MatchSet Master gels.  The SSP is a 4 digit number.  The software divides the 
Master into rows and columns whose distances are placed so that there 
approximately an equal number of spots in each row/column section.  No section 
can have more than 100 spots:  this is because the last two digits correspond to 
the number of the spot in the section. The first digit is X- (column) coordinate 
representing the section (increasing from left to right edge of image), and the 
second digit is the Y- (row) coordinate of that section (increasing from 
<i>bottom</i> to <i>top</i> edge of image).  Thus at the upper right corner of 
the image, an SSP of 99<i>xx</i> is expected, where <i>xx</i> represents the 
number of the spot in the section. At the lower left, an SSP of 00<i>xx</i> is 
expected.

<h1>Match Sets</h1>
<p>
MatchSets are used to compare two or more gel images. Creating MatchSets is done 
after spot detection and editing.  However this can be done also under the 
Automated Detection and Matching interface (dialog window).

<p>
Recall that a single gel image is used to create a ScanSet which contain three 
images:  the raw image from the camera, a filtered image in which noise has been 
removed and contrast improved as a result (background subtraction and smoothing 
of intensity data), and the Gaussian image, which is a software-generated record 
of detected spots with their variable intensities as part of the record.
<p>
Several ScanSets (representing the different gels to be compared) are now 
combined to make a MatchSet.  A MatchSet may actually have only one ScanSet, and 
this is likely if only a single gel is to be analyzed and then go on to spot 
cutting.
<p>
Within a MatchSet, all the gel spot data in the Gaussians are used to prepare a 
software-generated (synthetic) image (like the Gaussian in a ScanSet) called a 
<b>Master</b>.	From the Master, all comparisons and analysis are made.
<p>
The Masters from different MatchSets are grouped into higher level MatchSets for 
additional comparisons (see below).
<p>
Within the MatchSet, the following comparisons are possible:
<ul>
<li>Calculating <i>M</i><sub>r</sub> and pI values
<li>Annotating spots
<li>grouping spots (within analysis sets)
<li>combining data from multiple replicate gels
<li>selecting spots for excision and analysis
<li>combining gels with different pH ranges into one large <q>cybergel</q>
</ul>
<p>
Note that for quantitative spot comparisons, the units of quantitation must be 
the same:  spot intensities measured as OD units cannot be compared to spot 
intensities measured in counts.

<h2>MatchSet Creation</h2>
<p>
Can be done in one of two ways:
<ol>
<li><b>Automated Detection and Matching</b><br>
 Call up the dialog under the Spot menu.  Combines spot detection and
 MatchSet creation into one operation.    Cannot be used for higher
 level MatchSet creation.
<li><b>New MatchSet</b><br>
 Call up the dialog under the Match menu.  Use this when working with
images that already have spot detection data (i.e., with existing ScanSets),
and when creating higher level MatchSets.
</ol>

<h3>Automated Detection and Matching</h3>
<p>
There are 4 steps to this interface.  The first two deal with spot detection and 
editing, which are separate operations also under the Spot menu.   The next two 
(Steps 3 and 4) deal with MatchSet creation.
<p>
In step 1, the gels to be compared (put into a MatchSet) are selected. Click the 
<b>Add</b> button to add filenames to the file list and <b>Remove</b> if any are 
listed that should not be compared (in case of a change of mind).
<p>
One gel will be used to generate the Master for the MatchSet creation. If a gel 
is not chosen, the software will select one based on the gel with the best 
average spot quality.
<p>
In step 2, the spots will be detected.  The parameters for detection will be 
obtained in either one of two ways:

<ol>
<li>Reading a parameter list saved in a file
<li>Editing the parameter list, which opens the Spot Detection Wizard
interface for creating a parameter set.  Read the section on
the use of the Spot Detection Wizard to understand this (above).
</ol>
<p>
In Step 3, MatchSet creation requires the following information:
<ol>
<li><b>Name</b><br>
One will be automatically generated, or the user can create a new name
(recommended).  For automatic generation of names, set the Application
tab in the Preferences dialog interface.
<li><b>Description</b><br>
This is not required, but gives the ability to describe what is happening.
It is recommended that this field be completed.
<li><b>Comments</b><br>
Additional information beyond the description can be provided here.
<li><b>Directory</b><br>
Indicates the folder to save the MatchSet.  The one listed is the one
last used during the use of this interface.
</ol>
<p>
Step 4 involves matching the spots on gels.  If there is only one gel,
then disable this step.  If there is more than one gel but matching is
not wanted, also disable this step.
<p>
If proceeding with matching, then try to work with the default parameters.

<h3>Using <i>Create MatchSet</i></h3>
<p>
This must be used if working with ScanSets that already have spot detection 
data, or if higher level MatchSets are created (grouped MatchSets).

<h1>Analysis Sets</h1>
<p>
Six different analysis sets are available:
<ol>
<li><b>Qualitative</b>.  Used to distinguish spots <i>present</i> in
one gel and <i>absent</i> in another.
<li><b>Quantitative</b>.  Used to distinguish spots present in two gels
with different samples, but whose quantity is present with a possibly
threshold fold-difference.
<li><b>Statistical</b>.  Spots considered significant based on a selected
compariative statistical test.
<li><b>Arbitrary</b>.  Manually selected spots.
<li><b>Boolean</b>.  Determined from comparing two or more analysis sets:
for example, the derivative analysis set shows <q>true</q> for a
spot present in analysis sets A and B.
<li><b>Matching</b>.  A spot cut list generated for spots either unique
to one member of a matchset, or present in all members of the set.
</ol>
<p>
When only a single gel is available and selected spots are to be cut,
the following steps are taken:
<ol>
<li>Make sure that a matchset has been generated for the gel image.
This is done with Automated Detection and Matching (even though no
gel matching has been done).
<li>Select <b>Analysis Set Manager</b> from the <b>Analysis</b> menu.
<li>A dialog box is shown with the matchset that is currently open.
 Click the <b>Create...</b> button.
<li>Select the <b>Arbitrary</b> type.  This means that spots will be
selected manually.
<li>A new dialog shows.  Make sure the option <b><q>All spots in
member</q></b> are selected.
</ol>

<h2>Annotation</h2>

<h1>Spot Cutting</h1>

<h2>Basic Excision Tool</h2>
<p>
The Basic Excision Tool should not be used if the gels will be treated
with digestion before mass spectrometry.  It is better to use the
Integrated Excision Tool, because the system keeps track of the gel
pieces and associated data (especially <i>M</i><sub>r</sub> and
pI information), which is not possible with the Basic Excision Tool.

<h3>Spot Cutter Setup</h3>
<p>
Call the Basic Excision dialog window.
<p>
There is a toolbar for the setup in the Setup fieldset.   This permits
several functions and activities described below.

<h4>Camera Focusing</h4>
<p>
See if a lens filter is installed or necessary.  Do all focusing after 
installing or removing a filter. For doing focusing, the exposure time can be 
adjusted using either the <b>Auto-Expose</b> or setting the <b>Time</b> in 
milliseconds. The <b>Ceiling</b> shows the highest pixel value in the focused 
region, and the <b>Levels</b> shows the gray scale levels in the image.  These 
values can be used to adjust camera aperture and position.

<h4>Set Cutting Tip Height</h4>
<p>
The cutting tip height is the distance that the tip drops down to cut a spot. 
Use the Lower Tip and Raise Tip buttons to adjust the cutting tip position. The 
tip should press lightly against the cutting mat surface.  After adjustment, the 
cutting tip height rarely needs re-adjustment.  Check it after several months, 
or if gel cutting seems messy or incomplete.

<h4>Cutter Settings</h4>
<p>
This dialog window has the user specify the model of the cutter, the type of 
microplate (96- or 384 well) as well as the order of loading cut pieces (by row 
or by column).

<h4>Well A1 Postion and Wash Station 1 Position</h4>
<p>
This tells the cutter where the coordinates of the first well (in first row and 
column) are of the receiving microplate.  The arrow buttons help make the 
adjustments in the X and Y coordinate plane.
<p>
There are four wash station for washing the tip between cuttings. It may be 
necessary to calibrate/adjust the position of these as well.

<h4>Other Settings</h4>
<p>
It may be necessary to specify the cutting tip diameter (either 1.0 or 1.5 mm). 
This is necessary for software to understand the cutting diameter.

<h3>Cutting Spots</h3>

<h4>Acquiring Image</h4>
<p>
Step 1 is acquiring the image.  In the dialog window, select lights on if a 
Coomassie- or silver-stained gel is being visualized, lights off if a membrane 
(PVDF or nitrocellulose) is being visualized, or UV on if a fluor-stained gel is 
being visualized. For UV lights, the exposure time is activated.  Note that the 
UV lamp has to warm up, so there may be a delay before exposure is acquired.
<p>
The system gets two images:  the one of the gel or membrane, and then one of the 
background for doing background subtracting.
<p>
Brightness and contrast in the image can be adjusted in software using the 
<b>Transform</b> tool.

<h4>Specifying Cuts</h4>
<p>
Step 2 is selecting the spots to be cut.  Use the toolbar for zooming in and out 
of the image, and moving from one zoomed-in region to another.
<p>
For adding single cuts on a spot, uncheck the checkbox <b>Multiple Cuts/Spot</b> 
(multiple cuts per spot), and then click the <b>Add Cut</b> button and click on 
the spot. It is best to make sure that the <b>Snap to Peak</b> checkbox is 
selected, since that positions the cut centered over the highest peak intensity 
for a spot, a value which is part of image data.
<p>
Note that multiple cuts of the same spot can be placed in their own individual 
wells of the microplate, or all within one well of the microplate.  For making 
multiple cuts on a single (usually large) spot or spot cluster, and placing them 
all in a single well of the microplate, make sure the Multiple Cuts/Spot is 
checked. Then drag a box with the mouse cursor around the spot:  the spot cut 
circles will automatically be placed in optimal positions on the spot and within 
the spot boundaries.
<p>
For making sure that all these spots go into individual wells of the microplate, 
the Multiple Cuts/Spot option <em>must be <strong>unchecked</strong></em>.  Make 
sure that the cut circles do not overlap, but only touch each other!
<p>
If a cut is being designated on the first spot, the <b>Enter Plate 
Information</b> dialog window appears.  The user is asked to enter the name of 
the microplate (if more than one will be used, it is a good idea to give a 
descriptive name, along with the number of the plate in the series).  If the 
system has a barcode scanner, the barcode is scanned at this time and 
automatically entered.

<h5>Moving Cut Circles</h5>
<p>
If the user wants to move a cut circle in the image, select the <b>Add Cut</b> 
button, move the mouse cursor inside the circle. The cursor changes to a 
multidirectional arrow.  Hold the left mouse button down and drag the cursor, 
which moves the circle, to the desired location, then release the mouse button.

<h4>Importing A Cut List</h4>
<p>
Cut lists are useful when more than there are two or more gels with similar cut 
lists.  It is not possible to import a list to a gel with cuts already added 
either manually or by import.  However, cuts can be added manually after 
importation of a list.

<h3>Setting Cutter Options</h3>
<p>
Step 3 involves setting a number of cutter options.

<dl>
<dt>Spin When Cutting
 <dd>The cutting tip spins while it cuts.  Recommended for all cutting of any 
type.  Can be deselected when testing X-Y positioning when no cutting is beind 
done.
<dt>Spin When Ejecting
 <dd>Cutting tip will also spin while ejecting cut piece into microplate well. 
Recommended only for PVDF or nitrocellulose membrane cuts.
<dt>Cut Longer
 <dd>The cutting tip will be held in the down position for a longer time when 
making a cut.
<dt>Double Eject
 <dd>The eject pin inside the cutting tip will push twice when ejecting. Useful 
for membrane cuts which might be sticking to the cutting tip.
<dt>No Spin While Lifting
 <dd>The tip will spin not only when cutting but also when lifting out. This 
might be useful for gel or blot applications
<dt>Backed Gel
 <dd>Check this if the gels have a backing on them.  This is not the same as 
cutting sheet.  This option is recommended for the 1.0 mm cutting tip only since 
use of it in the 1.5 mm may decrease the efficiency in picking out the gel cut.
<dt>Tip Motion Range
 <dd>During cutting, the tip will make a side-to-side motion to help in cutting. 
The value is set in millimeters.  The default is 2.0 and the maximum is 5.0 mm. 
The user needs to determine the optimum setting.
</dl>

<h3>Setting Wash Options</h3>
<p>
The wash stations are available and the options can be selected

<h3>Performing a Cut Run</h3>
<p>
Click Begin/Resume either to begin or resume a cut run.  The user is prompted to 
place a microplate if it is not already in. As cuts are made, the cut appears 
white on the screen.  Cuts yet to be made are circled in green.
<p>
After a run is started, a <b>Pause</b> button appears for stopping or pausing a 
run.

<h4>Confirmation of Cuts</h4>
<p>
Click the Confirm Cuts button to inspect the gel and verify correct
cutting.
<p>
Confirming fluorescent gels can be difficult.
<p>
If <b>Re-Cuts</b> must be made, there is a button to indicate that.

<h2>Integrated Excision Tool</h2>
<p>
Before spot cutting can occur, the images require additional processing
to generate <b>Analysis Sets</b>.

<h3 id="quantone">Bio-Rad's Quantity One</h3>
<p>
This software is used to image and analyze the following:
<ul>
<li>one-dimensional SDS-PAGE gels
<li>dot blots
<li>arrays
<li>colonies
</ul>
<p>
It can examine illuminated regions which are detected using radioactivty,
chemiluminesce, fluorescence, and color-stained samples from densitometers,
phosphor images, flourescent imagers, and gel doc systems.
<p>
Lane-based functions can determined molecular weights, isoelectric points,
VNTRs, presence/absence and up/down regulation of bands.  Software has
algorithms to deal with distortions (curvature/smiling of bands).
<p>
The workflow is as follows:
<ol>
<li>Acquire the image
<li>Optimize the image
<li>Peform one of the following:
 <ul>
 <li>Lane and Band Analysis
 <li>Volume Analysis
 <li>Colony Counting
 </ul>
<li>Report Results
</ol>
<p>
Alternatively the results of the optimized image can also be reported directly.

<p id="author">
S. M. Halloran

</div>


</body>
</html>
